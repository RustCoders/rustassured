<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rust Assured</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-P7RE6D7RW0"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-P7RE6D7RW0');
        </script>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Home - What's All This, Then?</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="debugging_multiple_files.html"><strong aria-hidden="true">1.1.</strong> Debugging Multiple Rust Files in VS Code</a></li></ol></li><li class="chapter-item expanded "><a href="early_experiments.html"><strong aria-hidden="true">2.</strong> Early Experiments</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="passing_objects.html"><strong aria-hidden="true">2.1.</strong> Passing Objects</a></li><li class="chapter-item expanded "><a href="fun_facts.html"><strong aria-hidden="true">2.2.</strong> Fun Rust Facts</a></li><li class="chapter-item expanded "><a href="displaying_custom_types.html"><strong aria-hidden="true">2.3.</strong> Displaying Custom Types</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Assured</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="whats-all-this-then"><a class="header" href="#whats-all-this-then">What's All This, Then?</a></h1>
<p>Once upon a time, some guys wanted to learn Rust. Their heroic tales were told in a book/website that became famous.</p>
<p>But that's getting ahead of ourselves.</p>
<p>This website is here and is not awesome and famous yet because you have to start somewhere.  So we started somewhere, with a web site built on <a href="https://rust-lang.github.io/mdBook/">mdbook</a>. </p>
<p>There are static site generators based on Rust too, and there's Wordpress and the rest of the blogging universe. But mdbook was handy. Either way, a static site is a nice cheap starting point.</p>
<h2 id="wheres-the-code-for-this"><a class="header" href="#wheres-the-code-for-this">Where's the Code for This?</a></h2>
<p>Yes, as a matter of fact, we <em>are</em> looking for contributions!  Thanks for asking.  Here's the <a href="https://github.com/RustCoders/rustassured">RustAssured repository</a>.</p>
<h2 id="oh-look"><a class="header" href="#oh-look">&quot;Oh Look!&quot;</a></h2>
<p>(said John).  You can <a href="https://rust-lang.github.io/mdBook/format/mdbook.html#rust-playground">run Rust code</a> right here in the book by doing something like:</p>
<pre>
```rust
println!("Hello, World!");
```
</pre>
<p>Here's what happens:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>println!(&quot;Hello, World!&quot;);
<span class="boring">}
</span></code></pre></pre>
<p>There is a lot more you can do like including files, and tagging sections of rust files so you can include snippets, and I do a lot of it in <a href="passing_objects.html">passing_objects.md</a>.</p>
<h3 id="the-adventure-continues"><a class="header" href="#the-adventure-continues">The adventure continues...</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging-multiple-rust-applications-in-vs-code"><a class="header" href="#debugging-multiple-rust-applications-in-vs-code">Debugging Multiple Rust Applications in VS Code</a></h1>
<p>Working on this blog in mdbook, I soon learned that it was possible to write individual &quot;application files&quot; and include them in markdown using a syntax that looked like this:</p>
<pre>
```rust
{{ #include &lt;filename&gt; }}
```
</pre>
<p>This made them runnable in the browser by sending the code out to Rust Playground to be compiled and run.  However, often when developing these, &quot;snippet-length&quot; application files, we want to run the program in the debugger.</p>
<p>At first this didn't seem possible, since the VS code debugger seemed to want to work with a Cargo configuration, and for all I knew when I began my research, Cargo could only build a single application or library at a time.  After digging into it for a little bit, however, it turned out that solving this puzzle was not only possible, but fairly easy.</p>
<h2 id="debugging-rust-in-vs-code----first-steps"><a class="header" href="#debugging-rust-in-vs-code----first-steps">Debugging Rust in VS Code -- First Steps</a></h2>
<p>Before we describe how to set up Rust for debugging multiple small applications, we need to back up and make sure we have the pre-requisites to debug <em>anything</em> in Rust.  To debug Rust, we first need to install two VS Code extensions:</p>
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=rust-lang.rust-analyzer">Rust-Analyzer</a> provides language support (code completion, navigation, etc). for Rust.</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb">CodeLLDB</a> is an extension that uses LLDB to debug Rust, C++, and other compiled languages.</li>
</ul>
<p>The next step after installing these extensions is to make sure you can set breakpoints in your source.  To do this, go into VS Code settings and search for the word &quot;Everywhere&quot; to bring up the setting &quot;Allow Breakpoints Everywhere&quot; and make sure that this option is checked.</p>
<h2 id="cargo-options-and-launchjson"><a class="header" href="#cargo-options-and-launchjson">Cargo Options and launch.json</a></h2>
<p>For debugging anything in Rust using VS Code, one essential resource is the <a href="https://doc.rust-lang.org/cargo/reference/cargo-targets.html">Cargo Targets</a> page of the Cargo Book. It turns out that there are a few more target types than simple binary targets (applications, defined in src/main.rs) and library targets (defined in src/lib.rs).</p>
<p>For example, it's possible to declare additional binary targets, with the source going in src/bin/target_name.rs, but each one of these requires a separate section in cargo.toml, plus a way to tell the debugger (via launch.json) which of these we want to run. That solution would work, but it would be much more high maintenance than we wanted.</p>
<p>Fortunately, the next piece of Cargo-ie goodness that we bumped into turned out to be just the thing we needed for our RustAssured snippets.  This was the <a href="https://doc.rust-lang.org/cargo/reference/cargo-targets.html#examples">examples directory</a>.  It turned out we could add any rust &quot;executable&quot; src file (i.e., a file with a main method) to that directory, and as long as we had a minimal cargo.toml in the root, we could run the file &lt;root&gt;/examples/expressions.rs (for example) with the cargo command <code>cargo run --example expressions</code>.</p>
<p>Here's all we need for our minimal cargo.toml file, which we placed in the root of the repository:</p>
<pre><code class="language-toml">[package]
name = &quot;unused&quot;
version = &quot;0.1.0&quot;
</code></pre>
<p>Now hang in there with me -- I know this is a lot of explanation, but believe it or not, we're almost done!  We have our extensions installed, our breakpoint setting set, and our stub cargo.toml file. </p>
<p>The only thing left to do is to add (or edit) the file .vscode/launch.json to contain this configuration:</p>
<pre><code class="language-json">{
    &quot;configurations&quot;: [
        {
            &quot;type&quot;: &quot;lldb&quot;,
            &quot;request&quot;: &quot;launch&quot;,
            &quot;name&quot;: &quot;Debug current examples file&quot;,
            &quot;cargo&quot;: {
                &quot;args&quot;: [
                    &quot;run&quot;,
                    &quot;--example&quot;,
                    &quot;${fileBasenameNoExtension}&quot;                    
                ]
            },
            &quot;args&quot;: []
        }  
    ]
}
</code></pre>
<p>It's possible to modify this to include whatever name you want and run any cargo command, for example, to run tests.  As written, it debugs the current file in the examples directory, so I can set a breakpoint to run these two lines of <a href="https://www.youtube.com/watch?v=gRazSO9xjFo">Swinging on a Star</a>, by Bing Crosby, one line at a time.</p>
<p><img src="images/fish.png" alt="If that sort of life is what you wish...You may grow up to be a fish!" title="Retro debugging!" /></p>
<p>And of course, now that I know that Bing Crosby's two lines about a fish work OK, what kind of a bad person would I be if I didn't let you run them in the browser, too?</p>
<p>Just click on the code below to see the run button:</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let lines = [
        &quot;A fish won't do anything but swim in a brook.&quot;.to_string(),
        &quot;He can't write his name or read a book.&quot;.to_string()
    ];
    for line in lines.iter() {
        println!(&quot;{}&quot;, line);
    }    
}
</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="early-experiments"><a class="header" href="#early-experiments">Early Experiments</a></h1>
<p>Our first experiments were just a hodge-podge of notes and other cool things we hacked on.  See the navigation bar over on the left for complete details!</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="passing-objects"><a class="header" href="#passing-objects">Passing Objects</a></h2>
<p>One of the things that's &quot;hard&quot; about Rust when you first start learning it are the different ways you can pass an object to a function or return one, and the types associated with them.</p>
<p>For example, Strings come in a few different flavors, and you need to know which one to use to return them.:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span>
<span class="boring">fn main() {
</span>// This works:
fn return_string() -&gt; String {
    let not_global = &quot;I return ok, because I'm not global.&quot;.to_string();
    not_global  // Funky Rust return syntax.
}

// This doesn't, uncomment to see the error
/*
fn return_broken() -&gt; String {
    let broken = &quot;Not OK -- I'm a global literal!&quot;;
    broken
}
*/

println!(&quot;{}&quot;, return_string());
<span class="boring">}
</span></code></pre></pre>
<h2 id="mutable-methods-vs-immutable-methods"><a class="header" href="#mutable-methods-vs-immutable-methods">Mutable methods vs immutable methods</a></h2>
<p>Before learning about passing objects, we need to create a basic &quot;object&quot; and test it, which has mutable and immutable methods.</p>
<pre><pre class="playground"><code class="language-rust">pub struct Person {
    name: String,
    state: String,
}

impl Person {
    // See https://rust-unofficial.github.io/patterns/idioms/ctor.html
    pub fn new(name: String, state: String) -&gt; Self {
        Self {
            name: name,
            state: state
        }
    }

    pub fn print(&amp;self) {
        println!(&quot;{} lives in {}.&quot;, self.name, self.state);
    }
    
    // Note it's &amp;mut, not mut&amp;
    pub fn move_to(&amp;mut self, state: String) {
        self.state = state;
    }
}

fn main() {
    let static_john = Person::new(&quot;John Lockwood&quot;.to_string(), &quot;California&quot;.to_string());
    static_john.print();

    // Static John can't move! Next line is an error
    // static_john.move_to(&quot;North Carolina&quot;.to_string());

    // Mutable John can
    let mut john = Person::new(&quot;John Lockwood&quot;.to_string(), &quot;California&quot;.to_string());

    john.print();

    john.move_to(&quot;North Carolina&quot;.to_string());
    john.print();
}
</code></pre></pre>
<h2 id="passing-objects-1"><a class="header" href="#passing-objects-1">Passing Objects</a></h2>
<p>Basically there are about four ways things can get passed around:</p>
<ul>
<li>Directly non-mutable</li>
<li>Directly mutable</li>
<li>By reference non-mutable</li>
<li>By reference mutable</li>
</ul>
<h3 id="passing-objects-directly"><a class="header" href="#passing-objects-directly">Passing objects directly</a></h3>
<p>This MOVES the object to a new owner.  If you do this, you can't use
the reference any more.  I.e.  Can do it mutably or not.</p>
<pre><code>fn pass_ownership_non_mutable(person: Person) {
    person.print();
}

fn pass_ownership_mutably(mut person: Person) {
    person.move_to(&quot;New York&quot;.to_string());
}
</code></pre>
<p>Calling:</p>
<pre><code>    // Pass a person not by reference
    let john2 = Person::new(&quot;John&quot;.to_string(), &quot;California&quot;.to_string());
    pass_ownership_non_mutable(john2);
    // Can't do -- borrowed after move:  E0382:
    // john2.print();


    // Note we don't need to declare this as mut here
    // for that it matches the function signature of pass_ownership_mutually
    let john3 = Person::new(&quot;John &quot;.to_string(), &quot;California&quot;.to_string());
    pass_ownership_mutably(john3);
    // Can't do -- borrowed after move:  E0382:
    // john3.print();
</code></pre>
<h3 id="passing-by-reference"><a class="header" href="#passing-by-reference">Passing by reference</a></h3>
<pre><code>fn pass_reference_non_mutable(person: &amp;Person) {
    person.print();
}

fn pass_reference_mutably(person: &amp;mut Person) {
    person.move_to(&quot;Washington&quot;.to_string());
    person.print();    
}
</code></pre>
<p>Calling:</p>
<pre><code>    let mut john3 = Person::new(&quot;John &quot;.to_string(), &quot;California&quot;.to_string());
    pass_reference_mutably(&amp;mut john3);

    // Reusing, ownership not transfered!
    pass_reference_non_mutable(&amp;john3);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fun-rust-facts"><a class="header" href="#fun-rust-facts">Fun Rust Facts</a></h1>
<p>This is just a collection of various notes.</p>
<p>Both Scott and John noticed how cool the <code>rustc --explain &lt;error&gt;</code> feature is.</p>
<h2 id="array-type-declarations"><a class="header" href="#array-type-declarations">Array Type Declarations</a></h2>
<p>Array type declarations and initializers are a bit different in Rust than in other languages.  Here are some examples</p>
<pre><pre class="playground"><code class="language-rust">// Array type and initialization examples

fn main() {

    // Let compiler figure out that it's an
    // array of 4 i32 elements
    let implicit = [1, 2, 3, 4]; 
    show_four(implicit, &quot;implicit&quot;);

    // Explicitly declare using type ; count syntax
    let explicit: [i32; 4] = [5, 6, 7, 8];
    show_four(explicit, &quot;explicit&quot;);
    
    // Explicitly declare and initialize
    // an array with 5 elements, each set to the
    // number 33.
    let five_33s: [i8; 5] = [33; 5];    
    println!(&quot;five_33s: {:?}&quot;, five_33s);
}

// First parameter is array of exactly 4 values of type i32
fn show_four(array: [i32; 4], name: &amp;str) {
    println!(&quot;{}: {:?}&quot;, name, array); 
}
</code></pre></pre>
<h2 id="expressions"><a class="header" href="#expressions">Expressions</a></h2>
<p>Expressions do not end in a semi-colon, and they return a value.  This can be used for function return values as well as interesting things like setting a value in a conditional expression.</p>
<pre><pre class="playground"><code class="language-rust">
fn add(x: i32, y: i32) -&gt; i32 {
    // Equivalent to &quot;return x + y;&quot;
    x + y
}

fn main() {

    // The add function uses an expression to return a value, see above.
    println!(&quot;2 + 2 = {}&quot;, add(2,2));

    let addend = 2;
    // Expressions can be return a value from a conditional as well.
    let result = {
        if addend &gt; 3 {
            addend
        } else {
            add(addend, addend)
        }
    };
    println!(&quot;The result was {}&quot;, result);

}
</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="displaying-custom-types-structs-in-rust"><a class="header" href="#displaying-custom-types-structs-in-rust">Displaying Custom Types (Structs) in Rust</a></h1>
<p>In <a href="https://doc.rust-lang.org/book/ch05-02-example-structs.html">An Example Program Using Structs</a>, the Rust Book showed some of the error messages we could get when trying to print a struct to the console. </p>
<p>That resource left unanswered the question of how to implement std::fmt::Display, so we added that in the version below.</p>
<pre><pre class="playground"><code class="language-rust">use std::fmt;

#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl fmt::Display for Rectangle {
    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
        write!(f, &quot;Rectangle{{ width: {}, height: {} }}&quot;, self.width, self.height)
    }
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    // For this to work, we needed fmt::Debug, given by #[derive(Debug)]
    println!(&quot;Using pretty_print:  rect1 is {:?}&quot;, rect1);
    
    // This too.  Here, make sure to use &amp;rect1, or dbg! will take ownership!
    // Note that the output of this line will only appear 
    // if you use rustc to compile rect_example.rs and run it.
    // It won't show up in mdbook!
    dbg!(&amp;rect1);

    // For this we needed fmt::Display, manually implemented.
    println!(&quot;Using display format: rect1 is {}&quot;, rect1);
}
</code></pre></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
